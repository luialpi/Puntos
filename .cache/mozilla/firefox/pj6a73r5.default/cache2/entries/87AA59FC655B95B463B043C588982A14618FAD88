!function(e,t){var n={error:{},model:{},parse:{},request:{},ad_module:{},session_manager:{}};n.debugMessage=function(t){return e.videoplaza&&e.videoplaza.debug&&e.videoplaza.debug[t]?e.videoplaza.debug[t]:t},function(t){t.error.ParseError=function(e){this.message=e,this.name="ParseError"},t.error.ParseError.prototype=new e.Error,t.error.ParseError.prototype.constructor=t.error.ParseError}(n),function(e){e.Tracker=function(){var t,n=function(){t=new e.request.VpTracker},r=function(e,n){return t.reportError(e,n)},i=function(e,n){return t.track(e,n)};return n.prototype={reportError:r,track:i},n}(),e.Tracker.errorEvents={ad:{error:"error"},creative:{invalidCreativeUri:"invalidCreativeUri",invalidCreative:"invalidCreative"}},e.Tracker.trackingEvents={ad:{impression:"0"},creative:{acceptInvitation:"1",clickThrough:"20",close:"7",creativeView:"90",collapse:"2",complete:"18",expand:"31",firstQuartile:"15",fullscreen:"37",midpoint:"16",mute:"32",pause:"34",resume:"36",rewind:"35",start:"14",thirdQuartile:"17",timeSpent:"100",unmute:"33"}}}(n),function(t){t.request.VpXHR=function(){},t.request.VpXHR.httpErrorCodeTranslation={503:"serviceUnavailableCode503",500:"internalServerErrorCode500",404:"requestedResourceNotFoundCode404",400:"badRequestToServerCode400",0:"requestCouldNotBeSentToServerCode0",ieError:"requestFailedError"},t.request.VpXHR.prototype.request=function(n,r,i,s){var o,u,a,f="GET";if(r||(r=2e3),i||(i=function(){}),s||(s=function(){}),e.XMLHttpRequest)if(o=new e.XMLHttpRequest,"withCredentials"in o){try{o.withCredentials=!0}catch(l){}try{o.open(f,n,!0),u=!1}catch(l){return void s(t.request.VpXHR.httpErrorCodeTranslation[0])}o.onreadystatechange=function(){4===o.readyState&&(a&&e.clearTimeout(a),200===o.status?i(o.responseText):u||s(t.request.VpXHR.httpErrorCodeTranslation[o.status]||"unknownError"))},a=e.setTimeout(function(){u=!0,o.abort(),s("requestTimeout")},r),o.send()}else if(e.XDomainRequest){o=new e.XDomainRequest,o.onload=function(){i(o.responseText)},o.onerror=function(){s(t.request.VpXHR.httpErrorCodeTranslation.ieError||"unknownError")},o.onprogress=function(){},o.ontimeout=function(){s("requestTimeout")};try{o.open(f,n),o.timeout=r,o.send()}catch(l){s(t.request.VpXHR.httpErrorCodeTranslation.ieError||"unknownError")}}else s("corsNotSupportedInBrowser")}}(n),function(e){e.request.Bucket=function(){},e.request.Bucket.isBucketEvent=function(){return!1},e.request.Bucket.prototype.add=function(){return!1},e.request.Bucket.prototype.empty=function(){return!1}}(n),function(t){t.request.LocalStorage=function(e){this.pidKey=e},t.request.LocalStorage.prototype.getObjectFromUri=function(e){var t={},n=e.split("?");if(n.length>0){if(t.base=n[0],t.params={},n[1])for(var r=n[1].split("&"),i=0;i<r.length;i++){var s=r[i].split("=");t.params[s[0]]=s[1]?s[1]:null}else t.params=null;return t}return null},t.request.LocalStorage.prototype.supportsLocalStorage=function(){try{return"localStorage"in e&&null!==e.localStorage}catch(t){return!1}},t.request.LocalStorage.prototype.getData=function(e){try{return localStorage.getItem(e)}catch(t){return null}},t.request.LocalStorage.prototype.setData=function(e,t){try{return localStorage.setItem(e,t),!0}catch(n){return!1}},t.request.LocalStorage.prototype.removeData=function(e){try{return localStorage.removeItem(e),!0}catch(t){return!1}},t.request.LocalStorage.prototype.getPersistentIdFromTicket=function(e){var t=null;if(this.supportsLocalStorage()&&e.length>0){var n=this.getObjectFromUri(e[0].trackingUris.impression[0]);if(n&&n.params&&n.params.pid&&(t=n.params.pid,!this.setData(this.pidKey,t)))return null}return t},t.request.LocalStorage.prototype.getPersistentIdFromLocalStorage=function(){return this.supportsLocalStorage()?this.getData(this.pidKey):null}}(n),function(e){function t(e){if(null===e||"object"!=typeof e)return e;var n=new e.constructor;for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function n(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){t[n]={};for(var r in e[n])e[n].hasOwnProperty(r)&&(t[n][e[n][r]]=r)}return t}function r(e){var t,n=/\[CACHEBUSTING\]|%5BCACHEBUSTING%5D/;return n.test(e)&&(t=Math.floor(89999999*Math.random()+1e7),e=e.replace(n,t.toString())),e}e.request.VpTracker=function(){this.vpXHR=new e.request.VpXHR,this.bucket=new e.request.Bucket,this.blocked={}},e.request.VpTracker.errorEvents=t(e.Tracker.errorEvents),e.request.VpTracker.trackingEvents=t(e.Tracker.trackingEvents),e.request.VpTracker.trackingEvents.ad.impression2="3",e.request.VpTracker.trackingEvents.creative.creativeView2="91",e.request.VpTracker.trackingEvents.creative.acceptInvitation2="4",e.request.VpTracker.trackingEvents.creative.interaction="10",e.request.VpTracker.errorEventNames=n(e.request.VpTracker.errorEvents),e.request.VpTracker.trackingEventNames=n(e.request.VpTracker.trackingEvents),e.request.VpTracker.prototype.trackUris=function(t){for(var n="",i=0;i<t.length;i++)n=t[i],e.request.Bucket.isBucketEvent(n)?this.bucket.add(r(t[i])):this.vpXHR.request(r(n),2e3)},e.request.VpTracker.prototype.block=function(t,n){return n||(n=""),t instanceof e.model.Trackable?(this.blocked[t.uniqueId+n]=!0,!0):!1},e.request.VpTracker.prototype.isBlocked=function(t,n){return n||(n=""),t instanceof e.model.Trackable?t.uniqueId+n in this.blocked:!1},e.request.VpTracker.prototype.trackCreativeEvent=function(t,n){var r,i=e.request.VpTracker.trackingEvents.creative,s=[i.clickThrough,i.creativeView,i.creativeView2],o=[i.acceptInvitation,i.clickThrough,i.close,i.collapse,i.expand,i.fullscreen,i.pause,i.resume,i.rewind,i.mute,i.unmute],u=[i.acceptInvitation,i.interaction,i.start,i.firstQuartile,i.midpoint,i.thirdQuartile,i.complete],a=[i.creativeView];return t instanceof e.model.Creative&&e.request.VpTracker.trackingEventNames.creative[n]?t instanceof e.model.Companion&&s.indexOf(n)<0?!1:(r=t.parent,this.isBlocked(r)||this.isBlocked(t)?!1:(o.indexOf(n)>-1&&t.type!==e.model.Creative.creativeTypes.companion&&this.track(t,i.interaction),n===i.complete?this.track(t,i.thirdQuartile):n===i.thirdQuartile?this.track(t,i.midpoint):n===i.midpoint?this.track(t,i.firstQuartile):n===i.firstQuartile&&this.track(t,i.start),n===i.timeSpent?!0:n!==i.clickThrough||t.type!==e.model.Creative.creativeTypes.nonLinear&&t.type!==e.model.Creative.creativeTypes.companion?(this.isBlocked(r,n)||this.isBlocked(t,n)?n===i.acceptInvitation?this.track(t,e.request.VpTracker.trackingEvents.creative.acceptInvitation2):n===i.creativeView&&this.track(t,e.request.VpTracker.trackingEvents.creative.creativeView2):(u.indexOf(n)>-1&&this.block(r,n),a.indexOf(n)>-1&&this.block(t,n),this.trackUris(t.trackingUris[e.request.VpTracker.trackingEventNames.creative[n]])),!0):t.resourceType!==e.model.NonLinearCreative.resourceTypes.staticResource?!1:!0)):!1},e.request.VpTracker.prototype.trackAdEvent=function(t,n){return t.constructor===e.model.Ad&&e.request.VpTracker.trackingEventNames.ad[n]?this.isBlocked(t)?!1:t.type===e.model.Ad.types.inventory&&n===e.request.VpTracker.trackingEvents.ad.impression?(this.block(t),this.trackUris(t.trackingUris[e.request.VpTracker.errorEventNames.ad.error]),!0):(this.isBlocked(t,n)?n===e.request.VpTracker.trackingEvents.ad.impression&&this.track(t,e.request.VpTracker.trackingEvents.ad.impression2):(n===e.request.VpTracker.trackingEvents.ad.impression&&this.block(t,n),this.trackUris(t.trackingUris[e.request.VpTracker.trackingEventNames.ad[n]])),!0):!1},e.request.VpTracker.prototype.track=function(t,n){return t?t.constructor===e.model.Ad?this.trackAdEvent(t,n):t instanceof e.model.Creative?this.trackCreativeEvent(t,n):!1:!1},e.request.VpTracker.prototype.reportError=function(t,n){var r;return t&&t instanceof e.model.Creative&&e.request.VpTracker.errorEventNames.creative[n]?(r=t.parent,this.isBlocked(r)||this.isBlocked(t)?!1:(t.type===e.model.Creative.creativeTypes.companion?this.block(t):(this.isBlocked(r,e.request.VpTracker.trackingEvents.ad.impression)||this.track(r,e.request.VpTracker.errorEventNames.ad.error),this.block(r)),!0)):!1}}(n),function(n){function r(e){return/(^(http|https)\:\/\/)?([a-z0-9\-]+)\.([a-z0-9\-]+)\.[a-z]+/i.test(e)}function i(e){var t;return e&&e.constructor===n.model.Ad?(t=new n.model.Ad,t.type=n.model.Ad.types.inventory,t.trackingUris=e.trackingUris,t):!1}n.request.VpAdCallModule=function(e,t){if(!r(e))throw new Error(n.debugMessage("invalidVpHost"));this.vpHost=e,this.adCallModuleSettings=t,this.videoplazaXHR=new n.request.VpXHR,this.vastParser=new n.parse.VastXmlParser,this.vpLocalStorage=new n.request.LocalStorage("vpPID")},n.request.VpAdCallModule.browser=function(){function t(e){return e in document.documentElement.style}var n=t("MozBoxSizing"),r=Object.prototype.toString.call(e.HTMLElement).indexOf("Constructor")>0,i=!r&&t("WebkitTransform"),s=t("msTransform");return{isSafari:r,isChrome:i,isIE:s,isFirefox:n}}(),n.request.VpAdCallModule.hasData=function(e){return e?e.constructor===Array&&0===e.length?!1:!0:!1},n.request.VpAdCallModule.validateNumber=function(e,t){if(e){if(n.request.VpAdCallModule.isNumber(e)){if(0>e)throw new Error(n.debugMessage(t+"IsLessThanZero"));return!0}throw new Error(n.debugMessage(t+"IsNaN"))}return t+"IsMissing"},n.request.VpAdCallModule.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},n.request.VpAdCallModule.prototype.verifyRequestSettings=function(e,t){var r={height:"",width:"",maxBitRate:"",insertionPointType:"",playbackPosition:""},i="";if(!e)throw new Error(n.debugMessage("requestSettingsIsUndefined"));if(r.height=n.request.VpAdCallModule.validateNumber(e.height,"height"),r.width=n.request.VpAdCallModule.validateNumber(e.width,"width"),r.maxBitRate=n.request.VpAdCallModule.validateNumber(e.maxBitRate,"maxBitRate"),!e.insertionPointType)throw new Error(n.debugMessage("undefinedInsertionPointType"));switch(i=e.insertionPointType.toLowerCase()){case"onbeforecontent":case"oncontentend":case"playbacktime":r.insertionPointType="true";break;case"playbackposition":if(r.insertionPointType="true",!e.playbackPosition)throw new Error(n.debugMessage("undefinedPlaybackPosition"));if(r.playbackPosition="true",!n.request.VpAdCallModule.isNumber(e.playbackPosition))throw new Error(n.debugMessage("invalidPlaybackPosition"));if(n.request.VpAdCallModule.hasData(t)&&Number(e.playbackPosition)>Number(t))throw new Error(n.debugMessage("playbackPositionIsGtDuration"));break;default:throw new Error(n.debugMessage("invalidInsertionPointType"))}return r},n.request.VpAdCallModule.prototype.verifyContentMetadata=function(e){var t={contentForm:"",duration:""};if(!e)throw new Error(n.debugMessage("contentMetadataIsUndefined"));if(n.request.VpAdCallModule.hasData(e.contentForm)){var r=e.contentForm.toLowerCase();if(t.contentForm="true","shortform"!==r&&"longform"!==r)throw new Error(n.debugMessage("invalidContentForm"))}else t.contentForm="contentFormIsMissing";return t.duration=n.request.VpAdCallModule.validateNumber(e.duration,"duration"),t},n.request.VpAdCallModule.prototype.translateInsertionPointType=function(e){var t=e.toLowerCase();switch(t){case"onbeforecontent":return"p";case"playbackposition":return"m";case"oncontentend":return"po";case"playbacktime":return"o";default:throw new Error(n.debugMessage("invalidInsertionPointType"))}},n.request.VpAdCallModule.prototype.buildUrl=function(t,r){var i=this.vpHost;if(-1===i.indexOf("http://")&&-1===i.indexOf("https://")&&(i="http://"+i),i.lastIndexOf("/")!==i.length-1&&(i+="/"),i+="proxy/distributor/v2?",i+="rt=vast_2.0",i+="&pf=html5",i+="&cv=h5_"+e.videoplaza.versionNumber,t){n.request.VpAdCallModule.hasData(t.flags)&&(i+="&f="+encodeURIComponent(t.flags.join(","))),n.request.VpAdCallModule.hasData(t.tags)&&(i+="&t="+encodeURIComponent(t.tags.join(",")));var s="";if(n.request.VpAdCallModule.hasData(t.category)&&(s+=t.category),t.contentPartner&&n.request.VpAdCallModule.hasData(t.contentPartner)&&(s=n.request.VpAdCallModule.hasData(s)?s+=","+t.contentPartner:t.contentPartner),n.request.VpAdCallModule.hasData(s)&&(i+="&s="+encodeURIComponent(s)),n.request.VpAdCallModule.hasData(t.contentForm)&&(i+="&cf="+this.translateContentForm(t.contentForm)),n.request.VpAdCallModule.hasData(t.contentId)&&(i+="&ci="+encodeURIComponent(t.contentId)),n.request.VpAdCallModule.hasData(t.duration)&&(i+="&cd="+t.duration),n.request.VpAdCallModule.hasData(t.customParameters)){var o=/[^A-Za-z0-9_~\-.]/;for(var u in t.customParameters)t.customParameters.hasOwnProperty(u)&&!o.test(u)&&(i+="&cp."+u+"="+encodeURIComponent(t.customParameters[u]))}}if(r){if(n.request.VpAdCallModule.hasData(r.width)&&(i+="&vwt="+r.width),n.request.VpAdCallModule.hasData(r.height)&&(i+="&vht="+r.height),n.request.VpAdCallModule.hasData(r.maxBitRate)&&(i+="&vbw="+r.maxBitRate),n.request.VpAdCallModule.hasData(r.insertionPointType)){var a=r.insertionPointType.toLowerCase();i+="&tt="+this.translateInsertionPointType(a),"playbackposition"===a&&n.request.VpAdCallModule.hasData(r.playbackPosition)&&(i+="&bp="+encodeURIComponent(r.playbackPosition))}n.request.VpAdCallModule.hasData(r.referrerUrl)&&(i+="&ru="+encodeURIComponent(r.referrerUrl))}if(this.adCallModuleSettings&&n.request.VpAdCallModule.hasData(this.adCallModuleSettings.deviceContainer)&&(i+="&dcid="+encodeURIComponent(this.adCallModuleSettings.deviceContainer)),this.adCallModuleSettings&&n.request.VpAdCallModule.hasData(this.adCallModuleSettings.persistentId))i+="&pid="+encodeURIComponent(this.adCallModuleSettings.persistentId);else{var f=this.vpLocalStorage.getPersistentIdFromLocalStorage();f&&(i+="&pid="+encodeURIComponent(f))}var l=this.getURLParameter("vppreview");return n.request.VpAdCallModule.hasData(l)&&(i+="&vppreview="+l),i+="&st="+encodeURIComponent("0:0,3,4,10,20:1,91,100"),i+="&rnd="+n.model.Trackable.generateUniqueId()},n.request.VpAdCallModule.prototype.translateContentForm=function(e){var t=e.toLowerCase();return"longform"===t?"long_form":"short_form"},n.request.VpAdCallModule.prototype.getURLParameter=function(t){var n="",r="[\\?&]"+t+"=([^&#]*)",i=new RegExp(r),s=i.exec(e.location.href.toString());return null!==s&&(n=s[1]),n},n.request.VpAdCallModule.prototype.requestAds=function(s,o,u,f){function l(r,s){function o(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=t[n].concat(e[n]));return t}function y(e,t){if(t.trackingUris=o(e.trackingUris,t.trackingUris),e.vastAdTagUri?t.vastAdTagUri=e.vastAdTagUri:delete t.vastAdTagUri,e.creatives)for(var r in e.creatives)!e.creatives.hasOwnProperty(r)||e.creatives[r]instanceof n.model.Companion||(t.creatives[r].duration=e.creatives[r].duration,t.creatives[r].trackingUris=o(e.creatives[r].trackingUris,t.creatives[r].trackingUris),t.creatives[r].mediaFiles=e.creatives[r].mediaFiles,t.creatives[r].clickThroughUri=e.creatives[r].clickThroughUri);return t}function b(e){d-=1,0===d&&u(e)}function w(e,t){var n=t.indexOf(e);t[n]=i(e),b(t)}d+=1,h.videoplazaXHR.request(r,g,function(r){var i,o;try{r=r.replace(/<!--[\s\S]*?-->/g,""),i=h.vastParser.parse(r)}catch(u){return void (s?w(s,p):f(u.message))}if((s===t&&n.request.VpAdCallModule.browser.isSafari||n.request.VpAdCallModule.browser.isIE)&&h.vpLocalStorage.getPersistentIdFromTicket(i),s&&1!=i.length)return void w(s,p);for(var c=0;c<i.length;c++)o=i[c],s?o=y(o,s):p[c]=o,o.vastAdTagUri!==t?(s===t&&(v[o.id]=function(t){return e.setTimeout(function(){m=!0,w(t,p)},g)}(o)),m||l(o.vastAdTagUri,o)):v[o.id]!==t&&e.clearTimeout(v[o.id]);b(p)},function(e){s?w(s,p):f(e)})}var h=this,p=[],d=0,v={},m=!1,g=4e3;if("function"!=typeof u&&"function"!=typeof f)throw new Error(n.debugMessage("adRequestMissingMandatoryCallbacks"));if(!r(this.vpHost))throw new Error(n.debugMessage("invalidVpHost"));try{this.verifyContentMetadata(s),this.verifyRequestSettings(o,s.duration)}catch(y){return void f(y.message)}l(this.buildUrl(s,o))}}(n),function(e){e.model.Trackable=function(){this.trackingUris=null,this.uniqueId=null},e.model.Trackable.generateTrackingUris=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=[]);for(var i in t)t.hasOwnProperty(i)&&(n[i]=[]);return n},e.model.Trackable.generateUniqueId=function(){return Math.floor(1e16*Math.random())}}(n),function(e){e.model.Ad=function(){this.campaignId=null,this.creatives=[],this.customId=null,this.customGoalId=null,this.customCampaignId=null,this.goalId=null,this.id="0",this.labels={},this.type=null,this.variant=null,this.trackingUris=e.model.Trackable.generateTrackingUris(e.request.VpTracker.trackingEvents.ad,e.request.VpTracker.errorEvents.ad),this.uniqueId=e.model.Trackable.generateUniqueId()},e.model.Ad.types={inventory:"inventory",standard:"standard_spot"},e.model.Ad.variants={normal:"normal",sponsor:"sponsor"},e.model.Ad.prototype=new e.model.Trackable,e.model.Ad.prototype.constructor=e.model.Ad}(n),function(e){e.model.Creative=function(){this.clickThroughUri=null,this.duration=null,this.id=null,this.parent=null,this.type=null},e.model.Creative.creativeTypes={linear:"linear",nonLinear:"nonLinear",companion:"companion"},e.model.Creative.prototype=new e.model.Trackable,e.model.Creative.prototype.constructor=e.model.Creative}(n),function(e){e.model.MediaFile=function(){this.bitRate=null,this.deliveryMethod=null,this.height=null,this.id=null,this.mimeType=null,this.uri=null,this.width=null}}(n),function(e){e.model.LinearCreative=function(t){this.mediaFiles=[],this.parent=t||null,this.type=e.model.Creative.creativeTypes.linear,this.uniqueId=e.model.Trackable.generateUniqueId(),this.trackingUris=e.model.Trackable.generateTrackingUris(e.request.VpTracker.trackingEvents.creative)},e.model.LinearCreative.prototype=new e.model.Creative,e.model.LinearCreative.prototype.constructor=e.model.LinearCreative}(n),function(e){e.model.NonLinearCreative=function(t){this.height=null,this.mimeType=null,this.resource=null,this.resourceType=null,this.width=null,this.parent=t||null,this.type=e.model.Creative.creativeTypes.nonLinear,this.uniqueId=e.model.Trackable.generateUniqueId(),this.trackingUris=e.model.Trackable.generateTrackingUris(e.request.VpTracker.trackingEvents.creative)},e.model.NonLinearCreative.resourceTypes={staticResource:"staticResource",iFrame:"iFrame",html:"html"},e.model.NonLinearCreative.prototype=new e.model.Creative,e.model.NonLinearCreative.prototype.constructor=e.model.NonLinearCreative}(n),function(e){e.model.Companion=function(t){this.zoneId=null,this.zoneType=null,this.parent=t||null,this.type=e.model.Creative.creativeTypes.companion,this.uniqueId=e.model.Trackable.generateUniqueId(),this.trackingUris=e.model.Trackable.generateTrackingUris(e.request.VpTracker.trackingEvents.creative)},e.model.Companion.zoneTypes={html:"html"},e.model.Companion.prototype=new e.model.NonLinearCreative,e.model.Companion.prototype.constructor=e.model.Companion}(n),function(t){function n(e){var t=e.split(":"),n=0;if(t.length>0&&t.length<=3){for(var r=0;r<t.length;r++)n+=Number(t[t.length-r-1]*(r?Math.pow(60,r):1));return isNaN(n)?null:n}return null}function r(e,t){return"2.0"===t&&-1===e.indexOf("[CACHEBUSTING]")&&-1===e.indexOf("%5BCACHEBUSTING%5D")&&e.length>0&&(e+=e.indexOf("?")>-1?"&rnd=[CACHEBUSTING]":"?rnd=[CACHEBUSTING]"),e}function i(e){return e&&(e=e.toLowerCase(),"bumper"===e||e===t.model.Ad.variants.sponsor)?t.model.Ad.variants.sponsor:t.model.Ad.variants.normal}t.parse.VastXmlParser=function(){this.parser=new e.DOMParser},t.parse.VastXmlParser.prototype.getAttributeValue=function(e,t){var n;return e&&e.attributes&&(n=e.attributes.getNamedItem(t))?n.value:null},t.parse.VastXmlParser.prototype.createTrackingUris=function(e,n,i){var s,o,u,a;s={},o=n.getElementsByTagName("Tracking");for(var f=0;f<o.length;f++)u=o.item(f),a=this.getAttributeValue(u,"event"),(a in t.request.VpTracker.trackingEvents.ad||a in t.request.VpTracker.trackingEvents.creative||a in t.request.VpTracker.trackingEventNames.ad||a in t.request.VpTracker.trackingEventNames.creative)&&(a in t.request.VpTracker.trackingEventNames.ad?a=t.request.VpTracker.trackingEventNames.ad[a]:a in t.request.VpTracker.trackingEventNames.creative&&(a=t.request.VpTracker.trackingEventNames.creative[a]),s[a]||(s[a]=[]),s[a].push(r(this.trim(u.textContent),i)));for(a in s)e[a]&&(e[a]=e[a].concat(s[a]));return e},t.parse.VastXmlParser.prototype.createCreatives=function(e,i,s,o){for(var u,f,l,c,h,p,d,v,m,g,y,w,E,S=[],x={Linear:t.model.Creative.creativeTypes.linear,NonLinearAds:t.model.Creative.creativeTypes.nonLinear,CompanionAds:t.model.Creative.creativeTypes.companion},T={StaticResource:t.model.NonLinearCreative.resourceTypes.staticResource,IFrameResource:t.model.NonLinearCreative.resourceTypes.iFrame,HTMLResource:t.model.NonLinearCreative.resourceTypes.html},N=0;N<e.length;N++)if(u=this.getAttributeValue(e[N],"id"),f=x[e[N].firstChild.nodeName],f===t.model.Creative.creativeTypes.linear){for(l=new t.model.LinearCreative(i),l.id=u,c=e[N].getElementsByTagName("Duration"),c.length>0&&(l.duration=n(c[0].textContent)),h=e[N].getElementsByTagName("TrackingEvents"),h.length>0&&(l.trackingUris=this.createTrackingUris(l.trackingUris,h[0],o)),d=e[N].getElementsByTagName("ClickTracking"),p=0;p<d.length;p++)l.trackingUris.clickThrough.push(r(this.trim(d[p].textContent),o));for(v=e[N].getElementsByTagName("ClickThrough"),v.length>0&&(l.clickThroughUri=this.trim(v[0].textContent)),m=e[N].getElementsByTagName("MediaFile"),p=0;p<m.length;p++)g=new t.model.MediaFile,g.bitRate=this.getAttributeValue(m[p],"bitrate"),g.deliveryMethod=this.getAttributeValue(m[p],"delivery"),g.height=this.getAttributeValue(m[p],"height"),g.id=this.getAttributeValue(m[p],"id"),g.mimeType=this.getAttributeValue(m[p],"type"),g.uri=m[p].textContent,g.width=this.getAttributeValue(m[p],"width"),l.mediaFiles.push(g);S.push(l)}else if(f===t.model.Creative.creativeTypes.nonLinear)w=e[N].getElementsByTagName("NonLinear");else if(f===t.model.Creative.creativeTypes.companion)for(E=e[N].getElementsByTagName("Companion"),p=0;p<E.length;p++)l=new t.model.Companion(i),E[p].getElementsByTagName("TrackingEvents")[0]&&(l.trackingUris=this.createTrackingUris(l.trackingUris,E[p].getElementsByTagName("TrackingEvents")[0])),y=E[p].firstChild,l.resourceType=T[y.nodeName],l.resource=y.textContent,l.height=this.getAttributeValue(E[p],"height"),l.id=this.getAttributeValue(E[p],"id"),l.width=this.getAttributeValue(E[p],"width"),s&&s[l.id]?(l.zoneId=s[l.id].zoneId,l.zoneType=s[l.id].zoneMethod):"undefined"!=typeof console&&console.log("No matching companion in AdInfo."),S.push(l);return S},t.parse.VastXmlParser.prototype.createAds=function(e,n){for(var s,o,u,a,f,l,h,p,d,v=[],m=[],g={COMPANION_BANNER_JAVASCRIPT:t.model.Companion.zoneTypes.html},y=!1,w=0;w<e.length;w++){if(s=new t.model.Ad,e[w].getElementsByTagName("AdSystem").length>0){var E=e[w].getElementsByTagName("AdSystem")[0].textContent;E&&E.toLowerCase().indexOf("videoplaza karbon")>-1&&(y=!0)}for("Wrapper"===e[w].firstChild.nodeName?(o=e[w].getElementsByTagName("VASTAdTagURI"),o.length>0&&(s.vastAdTagUri=o[0].textContent)):o=null,s.id=this.getAttributeValue(e[w],"id"),null===s.id&&(s.id="0",s.type=t.model.Ad.types.inventory),a=e[w].getElementsByTagName("Extension"),u=0;u<a.length;u++)if("AdServer"===this.getAttributeValue(a[u],"type")&&"Videoplaza"===this.getAttributeValue(a[u],"name")){f=a[u].getElementsByTagName("AdInfo")[0],s.campaignId=this.getAttributeValue(f,"cid"),s.customId=this.getAttributeValue(f,"customaid"),s.customGoalId=this.getAttributeValue(f,"customgid"),s.customCampaignId=this.getAttributeValue(f,"customcid"),s.goalId=this.getAttributeValue(f,"gid"),s.type=this.translateIncorrectAdType(this.getAttributeValue(f,"format")),s.variant=i(this.getAttributeValue(f,"variant")),l=f.getElementsByTagName("Companion");for(var S=0;S<l.length;S++)m[this.getAttributeValue(l[S],"id")]={zoneId:this.getAttributeValue(l[S],"zone"),zoneMethod:g[this.getAttributeValue(l[S],"zoneType")]}}for(h=e[w].getElementsByTagName("Impression"),u=0;u<h.length;u++)s.trackingUris.impression.push(r(this.trim(h[u].textContent),n));if(s.trackingUris.impression.length<1)throw new t.error.ParseError(t.debugMessage("noImpressionElement"));for(p=e[w].getElementsByTagName("Error"),null===o&&y&&0===p.length&&s.type===t.model.Ad.types.inventory&&(p=h),u=0;u<p.length;u++)s.trackingUris.error.push(r(this.trim(p[u].textContent),n));if(d=e[w].getElementsByTagName("Creative"),!y&&0===d.length&&null===o)throw new t.error.ParseError(t.debugMessage("noCreativeElement"));s.creatives=this.createCreatives(d,s,m,n),v.push(s)}return v},t.parse.VastXmlParser.prototype.translateIncorrectAdType=function(e){return"spot_standard"===e?"standard_spot":e},t.parse.VastXmlParser.prototype.removeTextNodes=function(e){var t,n,r=/^\s*$/;if(3===e.nodeType)r.test(e.nodeValue)&&e.parentNode.removeChild(e);else if(1===e.nodeType||9===e.nodeType)for(t=e.firstChild;t;)n=t.nextSibling,this.removeTextNodes(t),t=n},t.parse.VastXmlParser.prototype.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},t.parse.VastXmlParser.prototype.parse=function(e){var n,r,i,s,o=[];try{n=this.parser.parseFromString(e,"text/xml")}catch(u){throw"undefined"!=typeof console&&console.log(t.debugMessage("nonValidXML")),new t.error.ParseError("Could not parse VAST. "+u.message)}if(r=n.documentElement,!r)throw new t.error.ParseError("Could not parse VAST. No root element");if(this.removeTextNodes(r),"VAST"!==r.nodeName)throw r.getElementsByTagName("parsererror")&&r.getElementsByTagName("parsererror").length>0&&"undefined"!=typeof console&&console.log(t.debugMessage("nonValidXML")),"undefined"!=typeof console&&console.log(t.debugMessage("nonValidVASTTicket")),new t.error.ParseError('Could not parse VAST. Root element is not "VAST".');return s=this.getAttributeValue(r,"version"),i=r.getElementsByTagName("Ad"),i.length>0&&(o=this.createAds(i,s)),o}}(n),function(e){e.AdCallModule=function(){var t,n=function(n,r){t=new e.request.VpAdCallModule(n,r)};return n.prototype.requestAds=function(e,n,r,i){t.requestAds(e,n,r,i)},n}()}(n),function(n){n.ad_module.StandardSpot=function(e,n){function r(e){if(!e[0])return t;for(var n=0,r=e.length;r>n;n++)if("mp4"===e[n].uri.slice(-3))return console.log("[AD] selected file: "+e[n].uri),e[n].uri;return console.log("[AD] selected file: "+e[0].uri),e[0].uri}this.ad=e,this.videoElement=n,this.videoElement.src=r(e.creatives[0].mediaFiles),this.eventListeners={AdLoaded:[],AdStarted:[],AdStopped:[],AdImpression:[],AdVideoStart:[],AdVideoComplete:[],AdClickThru:[]}},n.ad_module.StandardSpot.prototype.addEventListener=function(e,t){this.eventListeners[e]&&this.eventListeners[e].push(t)},n.ad_module.StandardSpot.prototype.removeEventListener=function(e,t){if(this.eventListeners[e]){var n=this.eventListeners[e].indexOf(t);n>=0&&this.eventListeners[e].splice(n,1)}},n.ad_module.StandardSpot.prototype.dispatchEvent=function(e,t){if(this.eventListeners[e])for(var n=0;n<this.eventListeners[e].length;n++)this.eventListeners[e][n](e,t)},n.ad_module.StandardSpot.prototype.handshakeVersion=function(){return"2.0"},n.ad_module.StandardSpot.prototype.initAd=function(){function e(){t.videoElement.removeEventListener("canplaythrough",e),t.dispatchEvent("AdLoaded",t.ad)}var t=this;this.videoElement.addEventListener("canplaythrough",e),this.videoElement.load()},n.ad_module.StandardSpot.prototype.startAd=function(){function t(){return"ontouchstart"in e}function n(){i.ad.creatives[0].clickThroughUri&&0!=i.ad.creatives[0].clickThroughUri.trim().length&&(i.videoElement.pause(),e.open(i.ad.creatives[0].clickThroughUri),i.videoElement.removeEventListener(s,n),i.dispatchEvent("AdClickThru",i.ad))}function r(){i.videoElement.removeEventListener(s,n),i.videoElement.removeEventListener("ended",r),i.dispatchEvent("AdVideoComplete",i.ad),i.stopAd()}var i=this,s=t()?"touchstart":"click";i.videoElement.addEventListener(s,n),this.videoElement.addEventListener("ended",r),this.videoElement.play(),this.dispatchEvent("AdStarted",this.ad),this.dispatchEvent("AdImpression",this.ad),this.dispatchEvent("AdVideoStart",this.ad)},n.ad_module.StandardSpot.prototype.stopAd=function(){this.dispatchEvent("AdStopped",this.ad)}}(n),function(e){e.session_manager.SlotManager=function(){this.ads=[],this.currentAdModule=null,this.eventListeners={SlotStarted:[],SlotStopped:[],AdLoaded:[],AdStarted:[],AdStopped:[],AdImpression:[],AdVideoStart:[],AdVideoComplete:[],AdClickThru:[],AdError:[]}},e.session_manager.SlotManager.prototype.addEventListener=function(e,t){this.eventListeners[e]&&this.eventListeners[e].push(t)},e.session_manager.SlotManager.prototype.removeEventListener=function(e,t){if(this.eventListeners[e]){var n=this.eventListeners[e].indexOf(t);n>=0&&this.eventListeners[e].splice(n,1)}},e.session_manager.SlotManager.prototype.dispatchEvent=function(e,t){if(this.eventListeners[e])for(var n=0;n<this.eventListeners[e].length;n++)this.eventListeners[e][n](e,t)},e.session_manager.SlotManager.prototype.startAd=function(){function e(e,t){i.dispatchEvent(e,t)}function t(t,n){clearTimeout(r),e(t,n)}function n(s,o){clearTimeout(r),i.currentAdModule.removeEventListener("AdImpression",e),i.currentAdModule.removeEventListener("AdVideoStart",e),i.currentAdModule.removeEventListener("AdVideoComplete",e),i.currentAdModule.removeEventListener("AdClickThru",e),i.currentAdModule.removeEventListener("AdStarted",t),i.currentAdModule.removeEventListener("AdStopped",n),e(s,o)}var r,i=this;this.currentAdModule.addEventListener("AdImpression",e),this.currentAdModule.addEventListener("AdVideoStart",e),this.currentAdModule.addEventListener("AdVideoComplete",e),this.currentAdModule.addEventListener("AdClickThru",e),this.currentAdModule.addEventListener("AdStarted",t),this.currentAdModule.addEventListener("AdStopped",n),r=setTimeout(n,5e3),this.currentAdModule.startAd()},e.session_manager.SlotManager.prototype.initAd=function(e){function t(){clearTimeout(i),s.currentAdModule.removeEventListener("AdLoaded",t),s.startAd()}function n(r,o){clearTimeout(i),s.currentAdModule.removeEventListener("AdStopped",n),s.currentAdModule.removeEventListener("AdLoaded",t),s.dispatchEvent(r,o),s.initAd(e+1)}var r,i,s=this;return this.ads.length<=e?void this.dispatchEvent("SlotStopped",this.ads):void ("inventory"===this.ads[e].type?(this.dispatchEvent("AdImpression",this.ads[e]),this.initAd(e+1)):"standard_spot"===this.ads[e].type?(this.currentAdModule=new videoplaza.core.ad_module.StandardSpot(this.ads[e],document.getElementById("bcVideo")),r=this.currentAdModule.handshakeVersion("2.0"),this.currentAdModule.addEventListener("AdLoaded",t),this.currentAdModule.addEventListener("AdStopped",n),i=setTimeout(n,5e3),this.currentAdModule.initAd()):(this.dispatchEvent("AdError",this.ads[e]),this.initAd(e+1)))},e.session_manager.SlotManager.prototype.initSlot=function(e){e.constructor===Array&&(e.length<1||(this.ads=this.ads.concat(e),this.dispatchEvent("SlotStarted",this.ads),this.initAd(0)))}}(n),e.videoplaza||(e.videoplaza={}),e.videoplaza.core=n,e.videoplaza.buildDate="20150205",e.videoplaza.versionNumber="1.0.14.17.1-bc"}(window),define("videoplaza",function(e){return function(){var t,n;return t||e.videoplaza}}(this)),define("events/xbrowserDispatchEvent",[],function(){return{dispatchEvent:function(evt){if(document.createEvent){var customEvent=document.createEvent("HTMLEvents");customEvent.initEvent(evt,!0,!1),document.dispatchEvent(customEvent)}else{var evtIE="on"+evt;eval("document.documentElement."+evtIE+"++")}}}}),define("core/adRequest",["videoplaza","events/xbrowserDispatchEvent"],function(e,t){function f(e){u("adRequest","Ad request fail: "+e),t.dispatchEvent("AdRequestFail")}function l(e){o("adRequest","Ad request success"),o("adRequest","["+e.length+"] Ad available, "+c(e)),s=e,t.dispatchEvent("AdRequestSuccess")}function c(e){var t="";for(var n=0;n<e.length;n++)t+="Ad["+n+"] is type: "+e[n].type+", ";return t.slice(0,-2)}function h(t){n=new e.core.AdCallModule(t.vphost);var s={};if(t.vpcustomparameters)try{s=typeof t.vpcustomparameters=="string"?JSON.parse(t.vpcustomparameters):t.vpcustomparameters}catch(u){o("adRequest",u)}r={category:t.vpcategory?t.vpcategory:undefined,tags:t.vptags?[t.vptags]:undefined,flags:t.vpflags?[t.vpflags]:undefined,contentForm:t.vpcontentform?t.vpcontentform:undefined,contentId:t.vpcontentid?t.vpcontentid:undefined,contentPartner:t.vpcontentpartner?t.vpcontentpartner:undefined,duration:0,customParameters:s},i={height:t.height,width:t.width,maxBitRate:t.maxbitrate?t.maxbitrate:"800",referrerUrl:t.referrerurl?t.referrerurl:"",insertionPointType:"onBeforeContent"},n.requestAds(r,i,l,f)}function p(){return s}var n,r,i,s=[],o=require("utils/logger").log,u=require("utils/logger").error,a=document;return{newAdRequest:h,getAds:p}}),define("core/adSession",["core/adRequest","events/xbrowserDispatchEvent"],function(e,t){function a(t){u("adSession","Start new Ad Session"),s=t,n.addEventListener("AdRequestSuccess",f),n.addEventListener("AdRequestFail",l),e.newAdRequest(s)}function f(){u("adSession","onAdRequestSuccess"),r=e.getAds(),r.length===0?t.dispatchEvent("AdsNotAvailable"):c(r[0])}function l(){t.dispatchEvent("AdLoadFail")}function c(e){u("adSession","Filter Selected Ad: "+e.type);switch(e.type){case"standard_spot":h(e);break;case"inventory":i.ad=e,t.dispatchEvent("AdInventory");break;default:o("adSession","Ad format: "+e.type+" not supported"),t.dispatchEvent("AdLoadFail")}}function h(e){var n=null,r,s=!1;for(var o=e.creatives.length-1;o>=0;o--)n=e.creatives[o],n.id==="video"?r=n:n.type==="companion"&&n.zoneId==="html5_player_poster"&&(s=!0,p(n.resource));i.ad=e,i.creative=r,i.src=d(n.mediaFiles),i.click=r.clickThroughUri,s||(i.poster="",i.controls=!0,t.dispatchEvent("AdSessionReady"))}function p(e){var n=new XMLHttpRequest,r;n.onreadystatechange=function(){n.readyState===4&&(r=n.responseText.split('src="'),i.poster=r[1].split('"')[0],i.controls=!1,t.dispatchEvent("AdSessionReady"))},n.open("GET",e,!0),n.send(null)}function d(e){for(var t=0,n=e.length;t<n;t++)if(e[t].uri.slice(-3)==="mp4")return e[t].uri;return e[0].uri}var n=document,r=[],i={},s,o=require("utils/logger").error,u=require("utils/logger").log;return{newAdSession:a,getCurrentAd:function(){return i},getAdInfo:function(){return i.ad}}}),define("core/adTrack",["videoplaza","core/adSession","events/xbrowserDispatchEvent"],function(e,t,n){function c(e){r=e}function h(){i.track(t.getCurrentAd().ad,s.ad.impression),n.dispatchEvent("AdLoaded")}function p(){i.track(t.getCurrentAd().ad,s.ad.impression),n.dispatchEvent("AdLoadFail")}function d(){i.track(t.getCurrentAd().creative,s.creative.start),n.dispatchEvent("AdPlayerStart")}function v(){i.track(t.getCurrentAd().creative,s.creative.complete),n.dispatchEvent("AdPlayerComplete")}function m(){i.track(t.getCurrentAd().creative,s.creative.clickThrough),n.dispatchEvent("AdClickThru")}function g(){i.track(t.getCurrentAd().creative,s.creative.close),n.dispatchEvent("AdPlayerClose")}function y(){i.track(t.getCurrentAd().creative,s.creative.creativeView)}function b(){u=t.getCurrentAd().creative.duration,a=Math.round(u/100*25),f=Math.round(u/100*50),l=Math.round(u/100*75),r.addEventListener("timeupdate",w)}function w(e){switch(Math.round(e.target.currentTime)){case a:i.track(t.getCurrentAd().creative,s.creative.firstQuartile),a=NaN,n.dispatchEvent("AdVideoFirstQuartile");return;case f:i.track(t.getCurrentAd().creative,s.creative.midpoint),f=NaN,n.dispatchEvent("AdVideoMidpoint");return;case l:i.track(t.getCurrentAd().creative,s.creative.thirdQuartile),r.removeEventListener("timeupdate",w),n.dispatchEvent("AdVideoThirdQuartile"),l=NaN;return}}function E(){i.reportError(t.getCurrentAd().creative,o.creative.invalidCreative)}function S(){i.reportError(t.getCurrentAd().creative,o.creative.invalidCreativeUri)}var r,i=new e.core.Tracker,s=e.core.Tracker.trackingEvents,o=e.core.Tracker.errorEvents,u=0,a=0,f=0,l=0;return{init:c,invalidCreative:E,invalidCreativeUri:S,impression:h,inventory:p,started:d,completed:v,clickThrough:m,close:g,companion:y,quartiles:b}}),define("core/player",["core/adSession","core/adTrack","events/xbrowserDispatchEvent"],function(e,t,n){function p(){i=e.getCurrentAd(),l=i.poster===""?!1:!0,h.removeEventListener("click",E),a("player","AdSessionReady with src: "+i.src),h.id="vp_inpage_player",h.src=i.src,h.style.height=o.height+"px",h.style.width=o.width+"px",h.style.backgroundColor="#000000",h.width=o.width,h.height=o.height,h.poster=i.poster,u.appendChild(h),t.init(h),l?h.addEventListener("click",S):C(!0),c&&(h.controls=!0),n.dispatchEvent("AdBannerLoaded")}function d(){a("player","AdPlayer Start"),h.removeEventListener("playing",d),l||h.addEventListener("click",E),t.quartiles()}function v(){a("player","Ad Loaded"),h.removeEventListener("playing",v),h.controls=!1,t.impression(),t.started()}function m(){a("player","AdPlayer Completed"),t.completed(),_()}function g(e){if(!e.target.error)return;f("player","HTML5 Video Playback Error Code: "+e.target.error.code),t.invalidCreative(),m()}function y(){a("player","Ad Load Fail"),t.invalidCreative(),m()}function b(){a("player","Ad Inventory"),t.inventory(),m()}function w(){m()}function E(){a("player","Ad Click: "+i.click),h.removeEventListener("click",E),i.click!==""&&(window.open(i.click),h.controls=!0,t.clickThrough(),n.dispatchEvent("AdClickThru"))}function S(){a("player","Poster Clicked, start playing!"),h.removeEventListener("click",S),l=!1,C(!0)}function x(){}function T(){t.close()}function N(t){a("player","start player"),M(),o=t,"getDiv"in o&&(u=o.getDiv()),e.newAdSession(o)}function C(e){a("player","setPlay: "+e),e&&!l?h.play():h.pause()}function k(e,t){h.style.width=e,h.style.height=t}function L(e){h.volume=e}function A(){return e.getAdInfo()}function O(){return r}function M(){s.addEventListener("AdSessionReady",p),s.addEventListener("AdLoadFail",y),s.addEventListener("AdInventory",b),s.addEventListener("AdsNotAvailable",w),h.addEventListener("canplaythrough",d),h.addEventListener("error",g),h.addEventListener("playing",v),h.addEventListener("ended",m)}function _(){s.removeEventListener("AdSessionReady",p),s.removeEventListener("AdLoadFail",y),s.removeEventListener("AdInventory",b),s.removeEventListener("AdsNotAvailable",w),h.removeEventListener("canplaythrough",d),h.removeEventListener("error",g),h.removeEventListener("ended",m)}var r={VERSION:"Videoplaza HTML5 Ad Player - 1.5 Standard",DATE_CREATED:"2014.03.18",DATE_RELEASED:"2015.10.29",AD_PLAYER_API:window.videoplaza.versionNumber},i,s=document,o,u,a=require("utils/logger").log,f=require("utils/logger").error,l,c=!!navigator.userAgent.match(/Mobile|Android/i),h=s.createElement("video");return{style:h.style,parentNode:{removeChild:function(){if(!h||!h.parentNode)return;h.parentNode.removeChild(h)},insertBefore:function(e,t){if(!h||!h.parentNode)return;var n=t?h:null;h.parentNode.insertBefore(e,n)}},nextSibling:h.nextSibling,start:N,close:T,setPlay:C,setSize:k,setVolume:L,getAdInfo:A,getPluginInfo:O}}),require.config({baseUrl:"../src",paths:{core:"core",config:"config",videoplaza:"../lib/html5-sdk-1.0.14.17.1-bc.min"},shim:{videoplaza:{exports:"videoplaza"}}}),require(["core/player","events/xbrowserDispatchEvent"],function(e,t){t.dispatchEvent("AdPlayerReady")}),define("main",function(){});)q)x6X      WŒÜWŒÜ<^ÊzWšì   B:http://cdn.videoplaza.tv/resources/inpage/1.5/vp_inpage_player.js necko:classified 1 request-method GET response-head HTTP/1.1 200 OK
Content-Type: application/javascript
Etag: "2109146663"
Last-Modified: Thu, 29 Oct 2015 13:21:31 GMT
Server: lighttpd/1.4.28
Content-Length: 39008
Accept-Ranges: bytes
X-Varnish: 1897489472 1867295251
Cache-Control: must-revalidate, max-age=3600
Expires: Thu, 21 Apr 2016 17:18:52 GMT
Date: Thu, 21 Apr 2016 16:18:52 GMT
 uncompressed-len 0   ˜`